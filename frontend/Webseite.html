<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Wild Life Observation</title>
  <style>
    body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('WebsiteBild.png') no-repeat center center;
  opacity: 0.15; /* Transparenz des Hintergrundbildes */
  z-index: -1;
}

    :root {
  --bg-light: #f5f5f5;
  --text-dark: #1a1a1a;
  --card: #ffffff;
  --accent: #e82127;
  --shadow: rgba(0, 0, 0, 0.05);
}

body {
  background-color: var(--bg-light);
  color: var(--text-dark);
  transition: background 0.4s ease, color 0.4s ease;
}

table tr {
  transition: background 0.2s ease;
}
table tr:hover {
  background: #f2f2f2;
}

/* Smooth Scroll */
html {
  scroll-behavior: smooth;
}

/* Fade-in animation on appear */
.fade-in {
  animation: fadeIn 0.6s ease-out forwards;
  opacity: 0;
  transform: translateY(10px);
}
@keyframes fadeIn {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Header style */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #fff;
  padding: 20px 40px;
  box-shadow: 0 4px 10px var(--shadow);
  border-radius: 0 0 20px 20px;
}

.dark-mode {
  --bg-light: #1b1b1b;
  --text-dark: #f5f5f5;
  --card: #2b2b2b;
  --accent: #e82127;
  --shadow: rgba(255, 255, 255, 0.04);
}

/* Toggle switch */
.toggle-btn {
  cursor: pointer;
  padding: 6px 14px;
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 6px;
  transition: background 0.3s ease;
}
.toggle-btn:hover {
  background: #c3141b;
}

    /* Animationen */
@keyframes fadeIn {
  0% { opacity: 0; transform: translateY(10px); }
  100% { opacity: 1; transform: translateY(0); }
}

/* Tabellen & Formulare smooth einblenden */
table, form {
  animation: fadeIn 0.6s ease-out both;
}

/* Hover-Animation für Buttons */
button {
  transition: transform 0.2s ease, background 0.3s ease;
}

button:hover {
  transform: scale(1.05);
}

/* Input Fokus Effekt */
form input:focus,
form select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(232, 33, 39, 0.15);
  transition: border 0.3s ease, box-shadow 0.3s ease;
}

    :root {
      --bg: #f5f5f5;
      --white: #fff;
      --dark: #111;
      --gray: #ccc;
      --primary: #000;
      --accent: #e82127;
    }

    body {
      margin: 0;
      padding: 40px 5vw;
      font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--dark);
    }

    h1, h2 {
      font-weight: 600;
      text-align: center;
      margin-bottom: 24px;
    }

    table {
      width: 100%;
      max-width: 900px;
      border-collapse: collapse;
      margin: 0 auto 40px;
      background: var(--white);
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      border-radius: 12px;
      overflow: hidden;
    }

    th, td {
      padding: 14px 18px;
      text-align: left;
      border-bottom: 1px solid var(--gray);
    }

    th {
      background: #fafafa;
      font-weight: 600;
      color: var(--dark);
    }

    td:last-child button {
      background: var(--accent);
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    td:last-child button:hover {
      background: #bb141b;
    }
    th.actions,
    td.actions {
      text-align: center;
      width: 110px;
    }

    .center {
      text-align: center;
    }
  form {
      max-width: 600px;
      margin: 40px auto;
      background: var(--white);
      padding: 32px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.04);
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 16px 20px;
    }

    form label {
      font-weight: 500;
      align-self: center;
    }

    form input,
    form select {
      padding: 10px;
      border: 1px solid var(--gray);
      border-radius: 8px;
      font-size: 14px;
      width: 100%;
      box-sizing: border-box;
      height: 40px;
    }

    form button {
      grid-column: span 2;
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 14px;
      font-size: 15px;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    form button:hover {
      background-color: #333;
    }

    /* Hamburger menu */
    #menuToggle {
      position: fixed;
      top: 20px;
      left: 20px;
      font-size: 26px;
      background: none;
      border: none;
      cursor: pointer;
      z-index: 1000;
    }

    #sideMenu {
      position: fixed;
      top: 0;
      left: 0;
      background: var(--card);
      box-shadow: 2px 0 8px rgba(0,0,0,0.2);
      padding: 60px 20px 20px 20px;
      transform: translateX(-100%);
      transition: transform 0.3s ease;
      height: 100%;
      z-index: 999;
    }

    #sideMenu.open {
      transform: translateX(0);
    }

    #sideMenu ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    #sideMenu li {
      margin-bottom: 16px;
    }

    #sideMenu a {
      color: var(--text-dark);
      text-decoration: none;
      font-weight: 600;
    }

    .content-section {
      display: none;
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 0;
    }

    .content-section.active {
      display: block;
    }

   

    @media (max-width: 768px) {
            form {
        grid-template-columns: 1fr;
      }

      form label {
        text-align: left;
      }
    }
  </style>
</head>
<body>

  <button id="menuToggle">&#9776;</button>
  <nav id="sideMenu">
    <ul>
     <li><a href="#" data-target="overviewSection">Übersicht</a></li>
      <li><a href="#" data-target="animalsSection">Tiere anlegen</a></li>
      <li><a href="#" data-target="genusSection">Gattungen anlegen</a></li>
      <li><a href="#" data-target="locationSection">Orte anlegen</a></li>
      <li><a href="#" data-target="observationSection">Beobachtungen anlegen</a></li>
    </ul>
  </nav>

 <div id="overviewSection" class="content-section active">
    <h1>Übersicht</h1>
    <h2>Tiere</h2>
    <table id="animalTable">
      <thead>
        <tr>
       <th>ID</th><th>Geschlecht</th><th>Alter (Jahre)</th><th>Gewicht (kg)</th><th>Größe (cm)</th><th>Gattung</th><th class="actions">Aktionen</th>  
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h2>Gattungen</h2>
    <table id="genusTable">
      <thead>
      <tr><th>ID</th><th>Bezeichnung</th><th class="center">Lateinische Bezeichnung</th><th class="actions">Aktionen</th></tr>
      </thead>
      <tbody></tbody>
    </table>

    <h2>Orte</h2>
    <table id="locationTable">
      <thead>
     <tr><th>ID</th><th class="left">Kurzbezeichnung</th><th>Beschreibung</th><th class="actions">Aktionen</th></tr>
      </thead>
      <tbody></tbody>
    </table>

    <h2>Beobachtungen</h2>
    <table id="observedTable">
      <thead>
        <tr><th>ID</th><th>Tier ID</th><th>Ort ID</th><th>Datum</th><th>Zeit</th><th class="actions">Aktionen</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="animalsSection" class="content-section">
    <h1>Tier anlegen</h1>
  <form id="addAnimalForm">
    <label>ID:</label>
    
   <input type="number" name="id" min="1" max="999999" required
           oninvalid="this.setCustomValidity('ID darf höchstens 6-stellig sein.')"
           oninput="this.setCustomValidity('')">
    <label>Geschlecht:</label>
    <select name="gender" id="genderSelect" required>
      <option value="">Bitte wählen</option>
      <option value="männlich">männlich</option>
      <option value="weiblich">weiblich</option>
    </select>
    <label>Alter (Jahre):</label>
   
    <input type="number" name="estimatedAge" min="0" max="999"
           required oninvalid="this.setCustomValidity('Alter darf höchstens 3-stellig sein.')"
           oninput="this.setCustomValidity('')">
    <label>Gewicht (kg):</label>
   
    <input type="number" name="estimatedWeight" step="0.1" min="0" max="999999"
           required oninvalid="this.setCustomValidity('Gewicht darf höchstens 6-stellig sein.')"
           oninput="this.setCustomValidity('')">
    <label>Größe (cm):</label>
   
    <input type="number" name="estimatedSize" step="0.1" min="0" max="9999"
           required oninvalid="this.setCustomValidity('Größe darf höchstens 4-stellig sein.')"
           oninput="this.setCustomValidity('')">
    <label>Gattung:</label>
    <select name="genusId" id="genusSelect" required>
      <option value="">Bitte wählen</option>
    </select>
    <button type="submit">Hinzufügen</button>
  </form>
  </div>

 

  <div id="genusSection" class="content-section">
  <h1>Gattung anlegen</h1>
  <form id="addGenusForm">
    <label>ID:</label>
    
    <input type="number" name="id" min="1" max="999999" required
           oninvalid="this.setCustomValidity('ID darf höchstens 6-stellig sein.')"
           oninput="this.setCustomValidity('')">
    <label>Bezeichnung:</label>
    <input type="text" name="designation" required>
    <label>Lateinische Bezeichnung:</label>
    <input type="text" name="latinDesignation" required>
    <button type="submit">Hinzufügen</button>
  </form>
  </div>

  

  <div id="locationSection" class="content-section">
  <h1>Ort anlegen</h1>
  <form id="addLocationForm">
    <label>ID:</label>
   
    <input type="number" name="id" min="1" max="999999" required
           oninvalid="this.setCustomValidity('ID darf höchstens 6-stellig sein.')"
           oninput="this.setCustomValidity('')">
    <label>Kurzbezeichnung:</label>
    <input type="text" name="shortTitle" required>
    <label>Beschreibung:</label>
    <input type="text" name="description" required>
    <button type="submit">Hinzufügen</button>
  </form>
  </div>

 

  <div id="observationSection" class="content-section">
  <h1>Beobachtung anlegen</h1>
  <form id="addObservedForm">
   <label>Tier:</label>

    <select name="animalId" id="animalSelect" required>
      <option value="">Bitte wählen</option>
    </select>
    <label>Ort:</label>

    <select name="locationId" id="locationSelect" required>
      <option value="">Bitte wählen</option>
    </select>
    <label>Datum:</label>
    <input type="date" name="date" required>
    <label>Zeit:</label>
    <input type="time" name="time" required>
    <button type="submit">Hinzufügen</button>
  </form>
  </div>

<script>
  const apiBase = 'http://localhost:8080';
  let genusData = [];

  // --- Tiere ---
  function loadAnimals() {
    fetch(apiBase + '/animal')
      .then(res => res.json())
      .then(data => {
        const tbody = document.querySelector('#animalTable tbody');
        tbody.innerHTML = '';
        data.forEach(a => {
          const genusName = a.genus ? `${a.genus.designation} (${a.genus.latinDesignation})` : '—';
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${a.id}</td>
            <td>${a.gender}</td>
            <td>${a.estimatedAge}</td>
            <td>${a.estimatedWeight}</td>
            <td>${a.estimatedSize}</td>
            <td>${genusName}</td>
           <td class="actions">
              <button onclick="toggleUpdateAnimal(this, ${a.id})">Update</button>
              <button onclick="deleteAnimal(${a.id})">Löschen</button>
            </td>
          `;
          tbody.appendChild(tr);
        });
        const animalSelect = document.getElementById('animalSelect');
        if (animalSelect) {
          animalSelect.innerHTML = '<option value="">Bitte wählen</option>';
          data.forEach(a => {
            const option = document.createElement('option');
            option.value = a.id;
            const genusName = a.genus ? `${a.genus.designation}` : '';
            option.textContent = `ID ${a.id} ${genusName}`.trim();
            animalSelect.appendChild(option);
          });
        }
      });
  }

  function deleteAnimal(id) {
    fetch(apiBase + '/animal/' + id, { method: 'DELETE' })
      .then(() => loadAnimals());
  }

  function toggleUpdateAnimal(btn, id) {
    const tr = btn.closest('tr');
    if (btn.dataset.editing !== 'true') {
      btn.dataset.editing = 'true';
      btn.textContent = 'Speichern';
      const cells = tr.querySelectorAll('td');
      cells[1].innerHTML = `<input value="${cells[1].textContent}">`;
      cells[2].innerHTML = `<input type="number" value="${cells[2].textContent}">`;
      cells[3].innerHTML = `<input type="number" value="${cells[3].textContent}">`;
      cells[4].innerHTML = `<input type="number" value="${cells[4].textContent}">`;
      const select = document.createElement('select');
      select.innerHTML = '<option value="">Bitte wählen</option>';
      genusData.forEach(g => {
        const opt = document.createElement('option');
        opt.value = g.id;
        opt.textContent = g.designation;
        if (cells[5].textContent.includes(g.designation)) opt.selected = true;
        select.appendChild(opt);
      });
      cells[5].textContent = '';
      cells[5].appendChild(select);
    } else {
      const cells = tr.querySelectorAll('td');
      const animal = {
        id: id,
        gender: cells[1].querySelector('input').value,
        estimatedAge: parseInt(cells[2].querySelector('input').value),
        estimatedWeight: parseFloat(cells[3].querySelector('input').value),
        estimatedSize: parseFloat(cells[4].querySelector('input').value)
      };
      const genusSel = cells[5].querySelector('select');
      animal.genus = genusSel.value ? {id: parseInt(genusSel.value)} : null;
      fetch(apiBase + '/animal/' + id, {
        method: 'PUT',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(animal)
      }).then(() => loadAnimals());
    }
  }

  document.getElementById('addAnimalForm').addEventListener('submit', e => {
    e.preventDefault();
    const form = e.target;
    const animal = {
      id: parseInt(form.id.value),
      gender: form.gender.value,
      estimatedAge: parseInt(form.estimatedAge.value),
      estimatedWeight: parseFloat(form.estimatedWeight.value),
      estimatedSize: parseFloat(form.estimatedSize.value),
      genus: {
        id: parseInt(form.genusId.value)
      }
    };
    fetch(apiBase + '/animal', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(animal)
    }).then(res => {
      if(!res.ok){
        return res.json().then(d => Promise.reject(d.message || 'id ist schon vergeben '));
      }
      form.reset();
      loadAnimals();
    }).catch(err => alert(err));
  });

  // --- Gattungen ---
  function loadGenus() {
    fetch(apiBase + '/genus')
      .then(res => res.json())
      .then(data => {
       genusData = data; 
        // Dropdown für Tierformular
        const select = document.getElementById('genusSelect');
        select.innerHTML = '<option value="">Bitte wählen</option>';
        data.forEach(g => {
          const option = document.createElement('option');
          option.value = g.id;
          option.textContent = `${g.designation} (${g.latinDesignation})`;
          select.appendChild(option);
        });

        // Tabelle anzeigen
        const tbody = document.querySelector('#genusTable tbody');
        tbody.innerHTML = '';
        data.forEach(g => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${g.id}</td>
            <td>${g.designation}</td>
            <td>${g.latinDesignation}</td>
            <td class="actions"><button onclick="deleteGenus(${g.id})">Löschen</button></td>
          `;
          tbody.appendChild(tr);
        });
      });
  }

  function deleteGenus(id) {
    fetch(apiBase + '/genus/' + id, { method: 'DELETE' })
      .then(() => {
        loadGenus();
        loadAnimals(); // Tiere ggf. aktualisieren, falls Genus gelöscht wurde
      });
  }

  document.getElementById('addGenusForm').addEventListener('submit', e => {
    e.preventDefault();
    const form = e.target;
    const genus = {
      id: parseInt(form.id.value),
      designation: form.designation.value,
      latinDesignation: form.latinDesignation.value
    };
    fetch(apiBase + '/genus', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(genus)
    }).then(res => {
      if(!res.ok){
        return res.json().then(d => Promise.reject(d.message || 'id ist schon vergeben'));
      }
      form.reset();
      loadGenus();
    }).catch(err => alert(err));
  });

  // --- Locations ---
  function loadLocations() {
    fetch(apiBase + '/location')
      .then(res => res.json())
      .then(data => {
        const tbody = document.querySelector('#locationTable tbody');
        tbody.innerHTML = '';
        data.forEach(l => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${l.id}</td>
            <td class="center">${l.shortTitle}</td>
            <td>${l.description}</td>
            <td class="actions">
              <button onclick="toggleUpdateLocation(this, ${l.id})">Update</button>
              <button onclick="deleteLocation(${l.id})">Löschen</button>
            </td>
          `;
          tbody.appendChild(tr);
        });
        const locationSelect = document.getElementById('locationSelect');
        if (locationSelect) {
          locationSelect.innerHTML = '<option value="">Bitte wählen</option>';
          data.forEach(l => {
            const option = document.createElement('option');
            option.value = l.id;
            option.textContent = `ID ${l.id} - ${l.shortTitle}`;
            locationSelect.appendChild(option);
          });
        }
      });
  }

  function deleteLocation(id) {
    fetch(apiBase + '/location/' + id, { method: 'DELETE' })
      .then(() => loadLocations());
  }

  function toggleUpdateLocation(btn, id) {
    const tr = btn.closest('tr');
    if (btn.dataset.editing !== 'true') {
      btn.dataset.editing = 'true';
      btn.textContent = 'Speichern';
      const cells = tr.querySelectorAll('td');
      cells[1].innerHTML = `<input value="${cells[1].textContent}">`;
      cells[2].innerHTML = `<input value="${cells[2].textContent}">`;
    } else {
      const cells = tr.querySelectorAll('td');
      const location = {
        id: id,
        shortTitle: cells[1].querySelector('input').value,
        description: cells[2].querySelector('input').value
      };
      fetch(apiBase + '/location/' + id, {
        method: 'PUT',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(location)
      }).then(() => loadLocations());
    }
  }

  document.getElementById('addLocationForm').addEventListener('submit', e => {
    e.preventDefault();
    const form = e.target;
    const location = {
      id: parseInt(form.id.value),
      shortTitle: form.shortTitle.value,
      description: form.description.value
    };
    fetch(apiBase + '/location', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(location)
    }).then(res => {
      if(!res.ok){
        return res.json().then(d => Promise.reject(d.message || 'id ist schon vergeben'));
      }
      form.reset();
      loadLocations();
    }).catch(err => alert(err));
  });

  // --- Beobachtungen ---
  function loadObservations() {
    fetch(apiBase + '/observed')
      .then(res => res.json())
      .then(data => {
        const tbody = document.querySelector('#observedTable tbody');
        tbody.innerHTML = '';
        data.forEach(o => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${o.id ?? '-'}</td>
            <td>${o.animalId ?? '-'}</td>
			<td>${o.locationId ?? '-'}</td>
            <td>${o.date ?? '-'}</td>
            <td>${o.time ?? '-'}</td>
            <td class="actions"><button onclick="deleteObservation(${o.id})">Löschen</button></td>
          `;
          tbody.appendChild(tr);
        });
      });
  }

  function deleteObservation(id) {
    fetch(apiBase + '/observed/' + id, { method: 'DELETE' })
      .then(() => loadObservations());
  }

  document.getElementById('addObservedForm').addEventListener('submit', e => {
    e.preventDefault();
    const form = e.target;
    const observed = {
      animal: { id: parseInt(form.animalId.value) },
      location: { id: parseInt(form.locationId.value) },
      date: form.date.value,
      time: form.time.value
    };
    fetch(apiBase + '/observed', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(observed)
    }).then(() => {
      form.reset();
      loadObservations();
    });
  });

  // Lade alle Daten initial
  
  loadGenus();
  loadAnimals();
  loadLocations();
  loadObservations();
// Navigation
  const menu = document.getElementById('sideMenu');
  document.getElementById('menuToggle').addEventListener('click', () => {
    menu.classList.toggle('open');
  });
  document.querySelectorAll('#sideMenu a').forEach(link => {
    link.addEventListener('click', e => {
      e.preventDefault();
      const target = link.dataset.target;
      document.querySelectorAll('.content-section').forEach(sec => {
        sec.classList.remove('active');
      });
      document.getElementById(target).classList.add('active');
      menu.classList.remove('open');
    });
  });
</script>
</body>
</html>